(this.webpackJsonpmuistiinpano=this.webpackJsonpmuistiinpano||[]).push([[0],{33:function(e,t,a){e.exports=a(67)},38:function(e,t,a){},44:function(e,t,a){},45:function(e,t,a){},46:function(e,t,a){},47:function(e,t,a){},65:function(e,t,a){},66:function(e,t,a){},67:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(30),u=a.n(l),i=a(5),c=a(1);a(38);function o(e){return r.a.createElement("div",{className:"linkBar"},e.links.map((function(e){return r.a.createElement(i.b,{key:e.link,to:e.link},r.a.createElement("div",{className:"linkBarItem"},e.text))})))}var s=a(3),m=a(12),f=a(13),d=a(15),v=a(14);a(44),a(45);function p(e){var t=e.errors;return null==t||0===t.length?null:r.a.createElement("span",null,e.errors.map((function(e){return r.a.createElement("span",{key:e},"Virhe: ",e)})))}function E(e){var t=e.errors,a=t.length>0;return r.a.createElement("span",{className:"textInput"},r.a.createElement("input",{type:"text",value:e.inputValue,onChange:e.onTextChange,onKeyUp:function(t){"Enter"===t.key&&e.onSubmit()},className:a?"erronous":""}),r.a.createElement("button",{disabled:a,onClick:e.onSubmit},"Lis\xe4\xe4"),r.a.createElement(p,{errors:t}))}a(46);function h(e){var t=e.measure;return r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement(i.b,{to:"/measure/"+t.id},r.a.createElement("span",{className:"nameLabel"},t.name)),"- vaihtosuhde: ",t.exchangeRatio),r.a.createElement("div",null,"Kokonaism\xe4\xe4r\xe4 (kokonaisvaikutus): ",t.valueSum," (",t.valueSum*t.exchangeRatio,")"))}var b=function(e){Object(d.a)(a,e);var t=Object(v.a)(a);function a(e){var n;return Object(m.a)(this,a),(n=t.call(this,e)).handleTextChange=function(e){var t=e.target.value,a=[];!isNaN(t.replace(",","."))||a.push("Input ei ole numero"),n.setState({errors:a,inputValue:t})},n.handleSubmit=function(e){var t=n.state.inputValue.replace(",",".").trim();""===t||isNaN(t)||(n.setState({inputValue:"",errors:[]}),n.props.onAddition(n.props.measure.id,parseFloat(t)))},n.state={inputValue:"",errors:[]},n}return Object(f.a)(a,[{key:"render",value:function(){var e=this.props.measure;return r.a.createElement("div",{className:"measure"},r.a.createElement(h,{measure:e}),r.a.createElement(E,{inputValue:this.state.inputValue,errors:this.state.errors,onTextChange:this.handleTextChange,onSubmit:this.handleSubmit}))}}]),a}(r.a.Component);a(47);function g(e){var t=e.balance;return r.a.createElement("div",{className:"balanceDisplay"},"Balance: ",r.a.createElement("span",{className:t>=0?"positive":"negative"},t))}var k=a(4),N=a.n(k),O="/api/measures/",j=function(){return N.a.get(O)},x=function(e){return N.a.get(O+e)},C=function(e){return N.a.post(O,e)},y=function(e){return N.a.put(O,e)},S=function(e){return N.a.post(O+"reset/"+e)},R=function(e){return N.a.delete(O+e.id)},T=function(e,t){return N.a.post(O+"reorder",{measureId:e.id,up:t})},V=function(e){return N.a.get("/api/measurements/"+e)},L=function(e,t){return N.a.post("/api/measurements/",{measureId:e,value:t})};function w(e){var t=Object(n.useState)(null),a=Object(s.a)(t,2),r=a[0],l=a[1],u=function(t){void 0===t?e().then((function(e){null!==e.data&&""!==e.data&&l(e.data)})):l(t)};return Object(n.useEffect)(u,[]),[r,u]}function M(){var e=w((function(){return j()})),t=Object(s.a)(e,2),a=t[0],n=t[1];if(null==a)return r.a.createElement("div",null,"Loading");var l=a.reduce((function(e,t){return e+t.valueSum*t.exchangeRatio}),0),u=function(e,t){L(e,t).then((function(e){200===e.status&&n()}))};return r.a.createElement("div",null,r.a.createElement(g,{balance:l}),r.a.createElement("div",null,a.map((function(e){return r.a.createElement(b,{key:e.name,measure:e,onAddition:u})}))))}function I(e){var t=e.measure;return r.a.createElement("div",null,r.a.createElement("div",null,"Mittari: ",t.name),r.a.createElement("div",null,"Vaihtosuhde: ",t.exchangeRatio))}function A(e){var t=e.values,a=e.first,n=e.last;return r.a.createElement("tr",null,D(a),t.length>0?t.map((function(e,t){return r.a.createElement("td",{key:t},e)})):null,D(n))}var D=function(e){return null===e||void 0===e?null:r.a.createElement("td",null,e)};function B(e){var t=e.measure,a=t.exchangeRatio,n=t.valueSum,l=e.measurements.map((function(e){return e.amount})),u=n*a,i=l.map((function(e,t){return"Transaktio: "+(t+1)})),c=l,o=l.map((function(e){return e*a})),s=0,m=l.map((function(e){return s+=e})),f=m.map((function(e){return e*a}));return r.a.createElement("table",null,r.a.createElement("thead",null,r.a.createElement(A,{values:i,first:"",last:"Total"})),r.a.createElement("tbody",null,r.a.createElement(A,{values:c,first:"Muutokset",last:n}),r.a.createElement(A,{values:o,first:"Reaalimuutokset",last:u}),r.a.createElement(A,{values:m,first:"Kokonaissummat",last:n}),r.a.createElement(A,{values:f,first:"Reaalisummat",last:u})))}function F(){var e=Object(c.g)().id,t=function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];var n=w((function(){return N.a.all(t).then(N.a.spread((function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return void 0!==t.find((function(e){return null===e.data||""===e.data}))?{data:null}:{data:t.map((function(e){return e.data}))}})))})),r=Object(s.a)(n,2),l=r[0],u=r[1],i=null===l?t.map((function(e){return null})):l;return[i,u]}(x(e),V(e)),a=Object(s.a)(t,1),n=Object(s.a)(a[0],2),l=n[0],u=n[1];return null==l||null==u?r.a.createElement("div",null,"Loading"):r.a.createElement("div",null,r.a.createElement(I,{measure:l}),r.a.createElement(B,{measure:l,measurements:u}))}a(65);function P(e){var t=e.measure;return r.a.createElement("li",{className:"listedMeasure"},r.a.createElement(i.b,{to:"/measure/"+t.id},t.name),r.a.createElement(i.b,{className:"listElement",to:"/measure/edit/"+t.id},"Muokkaa"),r.a.createElement("span",{className:"listElement clickable",onClick:function(a){window.confirm('Haluatko varmasti poistaa mittarin "'+t.name+'"?')&&e.onDelete(a)}},"Poista"),r.a.createElement("span",{className:"listElement"},"J\xe4rjest\xe4:",e.hasOrderUp?r.a.createElement("span",{className:"listElementPart clickable",onClick:function(a){return e.onReorder(t,!0)}},"^"):null,e.hasOrderDown?r.a.createElement("span",{className:"listElementPart clickable",onClick:function(a){return e.onReorder(t,!1)}},"v"):null))}function J(){var e=w((function(){return j()})),t=Object(s.a)(e,2),a=t[0],n=t[1],l=function(e,t){T(e,t).then((function(e){n()}))};if(null===a)return"";var u=a.length;return r.a.createElement("div",null,r.a.createElement("h1",null,"Mittarit"),r.a.createElement(i.b,{to:"/measure/new"},"Luo uusi mittari"),r.a.createElement("ul",null,a.map((function(e,t){return r.a.createElement(P,{key:e.id,measure:e,hasOrderUp:t>0,hasOrderDown:t<u-1,onDelete:function(t){return function(e){R(e).then((function(e){n()}))}(e)},onReorder:l})}))))}var K=function(e){Object(d.a)(a,e);var t=Object(v.a)(a);function a(e){var n;Object(m.a)(this,a),(n=t.call(this,e)).handleChange=function(e,t){var a={};a[e]=t,n.setState(a)},n.handleSubmit=function(){var e={};n.props.components.forEach((function(t){if(t.editable){var a=t.formatter,r=n.state[t.field];e[t.field]=null==a?r:a(r)}})),n.props.onSubmit(e)};var r={};return e.components.forEach((function(e){r[e.field]=e.value})),n.state=r,n}return Object(f.a)(a,[{key:"render",value:function(){var e=this,t=!0;return r.a.createElement("div",null,r.a.createElement("h1",null,this.props.headerText),this.props.components.map((function(a){var n=e.state[a.field],l=a.Component;if(a.editable){var u=a.validator(n);return t=t&&!u,r.a.createElement(l,{key:a.field,label:a.label,value:n,onChange:function(t){return e.handleChange(a.field,t)},error:u})}return r.a.createElement(l,{key:a.field,label:a.label,value:n})})),r.a.createElement("button",{disabled:!t,onClick:this.handleSubmit},this.props.submitText))}}]),a}(r.a.Component);a(66);function U(e){var t=e.label,a=e.value,n=e.onChange,l=e.error;return r.a.createElement("div",{className:"textField"},r.a.createElement("label",null,r.a.createElement("span",{className:"fieldLabel"},t,":"),r.a.createElement("input",{type:"text",value:a,onChange:function(e){return n(e.target.value)},className:l?"erronous":""}),l?r.a.createElement("span",{className:"errorMessage"},l):null))}function H(e){return function(t){return null===t||void 0===t||0===t.length?"Nimi ei saa olla tyhj\xe4":null==e.find((function(e){return e.name===t}))?null:"Mittari "+t+" on jo olemassa"}}function q(e){return null===e||void 0===e||0===(e=e.replace(",",".").trim()).length?"Sy\xf6t\xe4 luku":isNaN(e)?"Sy\xf6tetty teksti ei ole luku":null}function z(e){return parseFloat(e.replace(",",".").trim())}var G=function(){var e=Object(n.useState)(!1),t=Object(s.a)(e,2),a=t[0],l=t[1],u=w((function(){return j()})),i=Object(s.a)(u,1)[0];if(a)return r.a.createElement(c.a,{to:"/measures"});if(null==i)return r.a.createElement("div",null,"Loading");var o=[{label:"Nimi",field:"name",value:"",Component:U,editable:!0,validator:H(i)},{label:"Vaihtosuhde",field:"exchangeRatio",value:"1",Component:U,editable:!0,validator:q,formatter:z},{label:"Alkusumma",field:"sum",value:"0",Component:U,editable:!0,validator:q,formatter:z}];return r.a.createElement(K,{headerText:"Luo uusi mittari",submitText:"Luo",onSubmit:function(e){var t=e.name,a=e.sum,n=e.exchangeRatio;C({name:t,exchangeRatio:n,startValue:a}).then((function(e){200!==e.status||l(!0)}))},components:o})},Q=a(19),W=a(32);function X(e){var t=e.label,a=e.id,n=e.value,l=e.onChange,u=e.error;return r.a.createElement("div",{className:"textField"},r.a.createElement("label",null,r.a.createElement("span",{className:"fieldLabel"},t,":"),r.a.createElement("input",{type:"checkbox",id:a,value:n,onChange:function(e){return l(e.target.value)},className:u?"erronous":""}),u?r.a.createElement("span",{className:"errorMessage"},u):null))}var Y=function(){var e=Object(c.g)().id,t=w((function(){return x(e)})),a=Object(s.a)(t,2),l=a[0],u=a[1],i=w((function(){return j()})),o=Object(s.a)(i,1)[0],m=Object(n.useState)(!1),f=Object(s.a)(m,2),d=f[0],v=f[1];if(d)return r.a.createElement(c.a,{to:"/measures"});if(null==l||null==o)return r.a.createElement("div",null,"Loading");var p=o.filter((function(e){return e.id!=l.id})),E=[{field:"name",label:"Nimi",value:l.name,Component:U,editable:!0,validator:H(p)},{field:"exchangeRatio",label:"Vaihtosuhde",value:""+l.exchangeRatio,Component:U,editable:!0,validator:q,formatter:z},{field:"reset",label:"Nollaa",value:!1,Component:X,editable:!0,validator:function(){return null}}];return r.a.createElement(K,{headerText:"Muokkaa mittaria",submitText:"P\xe4ivit\xe4",components:E,onSubmit:function(t){var a=t.reset,n=Object(W.a)(t,["reset"]),r=Object(Q.a)(Object(Q.a)({},l),n),i=[y(r)];a&&i.push(S(e)),N.a.all(i).then(N.a.spread((function(){v(!0)}))),u(null)}})};function Z(){return r.a.createElement(i.a,null,r.a.createElement(o,{links:[{text:"Etusivu",link:"/"},{text:"Hallinnoi mittareita",link:"/measures"}]}),r.a.createElement(c.d,null,r.a.createElement(c.b,{path:"/measure/edit/:id"},r.a.createElement(Y,null)),r.a.createElement(c.b,{path:"/measure/new"},r.a.createElement(G,null)),r.a.createElement(c.b,{path:"/measure/:id"},r.a.createElement(F,null)),r.a.createElement(c.b,{path:"/measures"},r.a.createElement(J,null)),r.a.createElement(c.b,{path:"/"},r.a.createElement(M,null))))}u.a.render(r.a.createElement(Z,null),document.getElementById("root"))}},[[33,1,2]]]);
//# sourceMappingURL=main.2b16fc33.chunk.js.map